<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FIFA World Cup 2026 Simulator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #7e22ce 100%);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .trophy {
            font-size: 2em;
            margin: 0 10px;
        }

        .subtitle {
            font-size: 1.2em;
            color: #93c5fd;
            margin-top: 10px;
        }

        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .btn {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            background: #2563eb;
            transform: translateY(-2px);
        }

        .btn-success {
            background: #10b981;
        }

        .btn-success:hover {
            background: #059669;
        }

        .settings-panel {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            display: none;
        }

        .settings-panel.active {
            display: block;
        }

        .timezone-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .timezone-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .timezone-btn.active {
            background: #3b82f6;
            font-weight: bold;
        }

        .timezone-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .section-title {
            font-size: 2em;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .groups-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .group-card {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 20px;
        }

        .group-title {
            font-size: 1.5em;
            color: #fbbf24;
            margin-bottom: 15px;
        }

        .standings-table {
            width: 100%;
            margin-bottom: 20px;
            font-size: 0.9em;
        }

        .standings-table th,
        .standings-table td {
            padding: 8px 4px;
            text-align: center;
        }

        .standings-table th {
            border-bottom: 2px solid rgba(255,255,255,0.2);
        }

        .standings-table th:first-child,
        .standings-table td:first-child {
            text-align: left;
        }

        .standings-table tr.qualified {
            background: rgba(34,197,94,0.2);
        }

        .match-card {
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 12px;
        }

        .match-date {
            font-size: 0.85em;
            color: #d1d5db;
            margin-bottom: 8px;
        }

        .match-teams {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
        }

        .team-name {
            flex: 1;
            font-size: 0.9em;
        }

        .team-name.left {
            text-align: right;
        }

        .team-name.right {
            text-align: left;
        }

        .score-inputs {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .score-input {
            width: 50px;
            text-align: center;
            background: rgba(255,255,255,0.2);
            border: none;
            border-radius: 6px;
            padding: 8px;
            color: white;
            font-size: 16px;
        }

        .score-input:focus {
            outline: 2px solid #3b82f6;
        }

        .match-venue {
            font-size: 0.75em;
            color: #9ca3af;
            text-align: center;
            margin-top: 5px;
        }

        .knockout-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .stage-section {
            margin-bottom: 40px;
        }

        .stage-title {
            font-size: 1.8em;
            color: #fbbf24;
            margin-bottom: 20px;
            text-align: center;
        }

        .footer {
            text-align: center;
            margin-top: 60px;
            font-size: 0.9em;
            color: #d1d5db;
        }

        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }

            .groups-grid,
            .knockout-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    
    <div class="container">
        <!-- Header -->
         
        <div class="header">
            <h1>
                <div>
                    <span><img id="logo" src="DPLogo.PNG" alt="DPP Logo" height="40px" width="40px"></span>
                </div>
                <span class="trophy">ğŸ†</span>
                FIFA World Cup 2026
                <span class="trophy">ğŸ†</span>
                
            </h1>
            <p class="subtitle">Tournament Simulator & Predictor</p>
            <p style="font-size: 0.9em; color: #d1d5db; margin-top: 10px;">Canada â€¢ Mexico â€¢ United States</p>
        </div>

        <!-- Controls -->
        <div class="controls">
            <button class="btn" onclick="toggleSettings()">
                âš™ï¸ Settings
            </button>
            <button class="btn btn-success" onclick="exportToCSV()">
                ğŸ’¾ Export CSV
            </button>
            <button class="btn" onclick="resetAll()">
                ğŸ”„ Reset All
            </button>
        </div>
        <div class="controls">
            <p>Enter scores to simulate the tournament â€¢ Group winners and runners-up advance â€¢  Best 8 third-placed teams also qualify for Round of 32</p>
        </div>

        <!-- Settings Panel -->
        <div class="settings-panel" id="settingsPanel">
            <h3 style="margin-bottom: 15px;">Timezone Settings</h3>
            <div class="timezone-buttons" id="timezoneButtons"></div>
            <p style="margin-top: 15px; font-size: 0.9em; color: #d1d5db;">
                All match times will be displayed in <span id="currentTimezone">ET</span> timezone
            </p>
        </div>

        <!-- Group Stage -->
        <div class="section-title">ğŸ“… Group Stage</div>
        <div class="groups-grid" id="groupsContainer"></div>

        <!-- Knockout Stage -->
        <div class="section-title">ğŸ† Knockout Stage</div>
        
        <div class="stage-section">
            <div class="stage-title">Round of 32</div>
            <div class="knockout-grid" id="r32Container"></div>
        </div>

        <div class="stage-section">
            <div class="stage-title">Round of 16</div>
            <div class="knockout-grid" id="r16Container"></div>
        </div>

        <div class="stage-section">
            <div class="stage-title">Quarterfinals</div>
            <div class="knockout-grid" id="qfContainer"></div>
        </div>

        <div class="stage-section">
            <div class="stage-title">Semifinals</div>
            <div class="knockout-grid" id="sfContainer"></div>
        </div>

        <div class="stage-section">
            <div class="stage-title">Third Place Match</div>
            <div class="knockout-grid" id="thirdContainer"></div>
        </div>

        <div class="stage-section">
            <div class="stage-title">ğŸ† Final</div>
            <div class="knockout-grid" id="finalContainer"></div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>Made with help from AI's - Claude and Grok</p>
            <p>Design and Idea (C) Dipendra Paudel 2025 </p>
            <span><img id="logo" src="DPLogo.PNG" alt="DPP Logo" height="40px" width="40px"></span>
        </div>
        
    </div>

    <script>
        // Data
        const timezones = {
            'ET': 0, 'CT': -1, 'MT': -2, 'PT': -3,
            'GMT': 5, 'CET': 6, 'IST': 10.5, 'NPT': 10.75, 'JST': 14, 'AEST': 15
        };

        let currentTimezone = 'ET';
        let scores = JSON.parse(localStorage.getItem('wc2026scores')) || {};
        let assigned3rdPlaceTeams = new Set();

 const flagMap = {
            'Mexico': 'ğŸ‡²ğŸ‡½', 'South Africa': 'ğŸ‡¿ğŸ‡¦', 'Korea Republic': 'ğŸ‡°ğŸ‡·', 'UEFA PO D': 'â“',
            'Canada': 'ğŸ‡¨ğŸ‡¦', 'UEFA PO A': 'â“', 'Qatar': 'ğŸ‡¶ğŸ‡¦', 'Switzerland': 'ğŸ‡¨ğŸ‡­',
            'Brazil': 'ğŸ‡§ğŸ‡·', 'Morocco': 'ğŸ‡²ğŸ‡¦', 'Haiti': 'ğŸ‡­ğŸ‡¹', 'Scotland': 'ğŸ´ó §ó ¢ó ³ó £ó ´ó ¿',
            'United States': 'ğŸ‡ºğŸ‡¸', 'Paraguay': 'ğŸ‡µğŸ‡¾', 'Australia': 'ğŸ‡¦ğŸ‡º', 'UEFA PO C': 'â“',
            'Germany': 'ğŸ‡©ğŸ‡ª', 'CuraÃ§ao': 'ğŸ‡¨ğŸ‡¼', 'Ivory Coast': 'ğŸ‡¨ğŸ‡®', 'Ecuador': 'ğŸ‡ªğŸ‡¨',
            'Netherlands': 'ğŸ‡³ğŸ‡±', 'Japan': 'ğŸ‡¯ğŸ‡µ', 'UEFA PO B': 'â“', 'Tunisia': 'ğŸ‡¹ğŸ‡³',
            'Belgium': 'ğŸ‡§ğŸ‡ª', 'Egypt': 'ğŸ‡ªğŸ‡¬', 'Iran': 'ğŸ‡®ğŸ‡·', 'New Zealand': 'ğŸ‡³ğŸ‡¿',
            'Spain': 'ğŸ‡ªğŸ‡¸', 'Cape Verde': 'ğŸ‡¨ğŸ‡»', 'Saudi Arabia': 'ğŸ‡¸ğŸ‡¦', 'Uruguay': 'ğŸ‡ºğŸ‡¾',
            'France': 'ğŸ‡«ğŸ‡·', 'Senegal': 'ğŸ‡¸ğŸ‡³', 'Intercontinental PO 2': 'â“', 'Norway': 'ğŸ‡³ğŸ‡´',
            'Argentina': 'ğŸ‡¦ğŸ‡·', 'Algeria': 'ğŸ‡©ğŸ‡¿', 'Austria': 'ğŸ‡¦ğŸ‡¹', 'Jordan': 'ğŸ‡¯ğŸ‡´',
            'Portugal': 'ğŸ‡µğŸ‡¹', 'Intercontinental PO 1': 'â“', 'Uzbekistan': 'ğŸ‡ºğŸ‡¿', 'Colombia': 'ğŸ‡¨ğŸ‡´',
            'England': 'ğŸ´ó §ó ¢ó ¥ó ®ó §ó ¿', 'Croatia': 'ğŸ‡­ğŸ‡·', 'Ghana': 'ğŸ‡¬ğŸ‡­', 'Panama': 'ğŸ‡µğŸ‡¦'
        };


        const groups = {
            A: ['Mexico', 'South Africa', 'South Korea', 'UEFA PO-D'],
            B: ['Canada', 'Switzerland', 'Qatar', 'UEFA PO-A'],
            C: ['Brazil', 'Morocco', 'Scotland', 'Austria'],
            D: ['USA', 'Paraguay', 'Australia', 'UEFA PO-C'],
            E: ['Germany', 'Ecuador', 'CuraÃ§ao', 'Saudi Arabia'],
            F: ['Netherlands', 'Japan', 'Tunisia', 'UEFA PO-B'],
            G: ['Spain', 'Belgium', 'Egypt', 'Cape Verde'],
            H: ['Iran', 'New Zealand', 'Nigeria', 'Angola'],
            I: ['France', 'Norway', 'Senegal', 'ICPO-2'],
            J: ['Argentina', 'Austria', 'Jordan', 'Algeria'],
            K: ['Portugal', 'Colombia', 'Uzbekistan', 'ICPO-1'],
            L: ['England', 'Croatia', 'Ghana', 'Panama']
        };

        const groupMatches = [
            {id:1,group:'A',date:'2026-06-11',time:'15:00',team1:'Mexico',team2:'South Africa',venue:'Mexico City'},
            {id:2,group:'A',date:'2026-06-11',time:'22:00',team1:'South Korea',team2:'UEFA PO-D',venue:'Guadalajara'},
            {id:3,group:'A',date:'2026-06-18',time:'12:00',team1:'South Africa',team2:'UEFA PO-D',venue:'Atlanta'},
            {id:4,group:'A',date:'2026-06-18',time:'21:00',team1:'Mexico',team2:'South Korea',venue:'Guadalajara'},
            {id:5,group:'A',date:'2026-06-24',time:'21:00',team1:'UEFA PO-D',team2:'Mexico',venue:'Mexico City'},
            {id:6,group:'A',date:'2026-06-24',time:'21:00',team1:'South Korea',team2:'South Africa',venue:'Monterrey'},
            {id:7,group:'B',date:'2026-06-12',time:'15:00',team1:'Canada',team2:'UEFA PO-A',venue:'Toronto'},
            {id:8,group:'B',date:'2026-06-12',time:'15:00',team1:'Qatar',team2:'Switzerland',venue:'Santa Clara'},
            {id:9,group:'B',date:'2026-06-18',time:'15:00',team1:'Switzerland',team2:'UEFA PO-A',venue:'Los Angeles'},
            {id:10,group:'B',date:'2026-06-18',time:'15:00',team1:'Canada',team2:'Qatar',venue:'Vancouver'},
            {id:11,group:'B',date:'2026-06-24',time:'15:00',team1:'Canada',team2:'Switzerland',venue:'Vancouver'},
            {id:12,group:'B',date:'2026-06-24',time:'15:00',team1:'UEFA PO-A',team2:'Qatar',venue:'Seattle'},
            {id:13,group:'C',date:'2026-06-13',time:'18:00',team1:'Brazil',team2:'Morocco',venue:'Los Angeles'},
            {id:14,group:'C',date:'2026-06-14',time:'16:00',team1:'Austria',team2:'Scotland',venue:'Philadelphia'},
            {id:15,group:'C',date:'2026-06-19',time:'18:00',team1:'Morocco',team2:'Scotland',venue:'Boston'},
            {id:16,group:'C',date:'2026-06-19',time:'18:00',team1:'Brazil',team2:'Austria',venue:'Seattle'},
            {id:17,group:'C',date:'2026-06-24',time:'18:00',team1:'Scotland',team2:'Brazil',venue:'Miami'},
            {id:18,group:'C',date:'2026-06-24',time:'18:00',team1:'Morocco',team2:'Austria',venue:'Kansas City'},
            {id:19,group:'D',date:'2026-06-12',time:'21:00',team1:'USA',team2:'Paraguay',venue:'Los Angeles'},
            {id:20,group:'D',date:'2026-06-13',time:'00:00',team1:'Australia',team2:'UEFA PO-C',venue:'Vancouver'},
            {id:21,group:'D',date:'2026-06-19',time:'00:00',team1:'USA',team2:'Australia',venue:'Seattle'},
            {id:22,group:'D',date:'2026-06-19',time:'15:00',team1:'Paraguay',team2:'UEFA PO-C',venue:'Miami'},
            {id:23,group:'D',date:'2026-06-25',time:'22:00',team1:'USA',team2:'UEFA PO-C',venue:'Los Angeles'},
            {id:24,group:'D',date:'2026-06-25',time:'22:00',team1:'Australia',team2:'Paraguay',venue:'Houston'},
            {id:25,group:'E',date:'2026-06-14',time:'13:00',team1:'Germany',team2:'CuraÃ§ao',venue:'Houston'},
            {id:26,group:'E',date:'2026-06-14',time:'18:00',team1:'Ecuador',team2:'Saudi Arabia',venue:'Dallas'},
            {id:27,group:'E',date:'2026-06-20',time:'13:00',team1:'CuraÃ§ao',team2:'Saudi Arabia',venue:'Atlanta'},
            {id:28,group:'E',date:'2026-06-20',time:'19:00',team1:'Ecuador',team2:'Germany',venue:'Kansas City'},
            {id:29,group:'E',date:'2026-06-25',time:'16:00',team1:'Ecuador',team2:'CuraÃ§ao',venue:'New Jersey'},
            {id:30,group:'E',date:'2026-06-25',time:'16:00',team1:'Germany',team2:'Saudi Arabia',venue:'Toronto'},
            {id:31,group:'F',date:'2026-06-14',time:'16:00',team1:'Netherlands',team2:'Japan',venue:'Dallas'},
            {id:32,group:'F',date:'2026-06-15',time:'12:00',team1:'Tunisia',team2:'UEFA PO-B',venue:'Toronto'},
            {id:33,group:'F',date:'2026-06-20',time:'13:00',team1:'Netherlands',team2:'UEFA PO-B',venue:'Houston'},
            {id:34,group:'F',date:'2026-06-21',time:'12:00',team1:'Japan',team2:'Tunisia',venue:'Boston'},
            {id:35,group:'F',date:'2026-06-25',time:'19:00',team1:'Japan',team2:'UEFA PO-B',venue:'Dallas'},
            {id:36,group:'F',date:'2026-06-25',time:'19:00',team1:'Netherlands',team2:'Tunisia',venue:'Kansas City'},
            {id:37,group:'G',date:'2026-06-15',time:'15:00',team1:'Spain',team2:'Cape Verde',venue:'Atlanta'},
            {id:38,group:'G',date:'2026-06-15',time:'18:00',team1:'Belgium',team2:'Egypt',venue:'Seattle'},
            {id:39,group:'G',date:'2026-06-21',time:'15:00',team1:'Cape Verde',team2:'Egypt',venue:'Boston'},
            {id:40,group:'G',date:'2026-06-21',time:'15:00',team1:'Belgium',team2:'Spain',venue:'Toronto'},
            {id:41,group:'G',date:'2026-06-26',time:'15:00',team1:'Egypt',team2:'Spain',venue:'Miami'},
            {id:42,group:'G',date:'2026-06-26',time:'15:00',team1:'Belgium',team2:'Cape Verde',venue:'Vancouver'},
            {id:43,group:'H',date:'2026-06-15',time:'21:00',team1:'Iran',team2:'New Zealand',venue:'Los Angeles'},
            {id:44,group:'H',date:'2026-06-16',time:'13:00',team1:'Nigeria',team2:'Angola',venue:'Philadelphia'},
            {id:45,group:'H',date:'2026-06-21',time:'18:00',team1:'New Zealand',team2:'Angola',venue:'Santa Clara'},
            {id:46,group:'H',date:'2026-06-21',time:'15:00',team1:'Iran',team2:'Nigeria',venue:'Los Angeles'},
            {id:47,group:'H',date:'2026-06-26',time:'20:00',team1:'Angola',team2:'Iran',venue:'Houston'},
            {id:48,group:'H',date:'2026-06-26',time:'20:00',team1:'New Zealand',team2:'Nigeria',venue:'Miami'},
            {id:49,group:'I',date:'2026-06-16',time:'15:00',team1:'France',team2:'Senegal',venue:'New Jersey'},
            {id:50,group:'I',date:'2026-06-16',time:'18:00',team1:'ICPO-2',team2:'Norway',venue:'Boston'},
            {id:51,group:'I',date:'2026-06-22',time:'17:00',team1:'France',team2:'ICPO-2',venue:'Philadelphia'},
            {id:52,group:'I',date:'2026-06-22',time:'20:00',team1:'Norway',team2:'Senegal',venue:'New Jersey'},
            {id:53,group:'I',date:'2026-06-27',time:'12:00',team1:'Senegal',team2:'ICPO-2',venue:'Santa Clara'},
            {id:54,group:'I',date:'2026-06-27',time:'12:00',team1:'France',team2:'Norway',venue:'Vancouver'},
            {id:55,group:'J',date:'2026-06-16',time:'21:00',team1:'Argentina',team2:'Algeria',venue:'Kansas City'},
            {id:56,group:'J',date:'2026-06-17',time:'00:00',team1:'Austria',team2:'Jordan',venue:'Santa Clara'},
            {id:57,group:'J',date:'2026-06-22',time:'13:00',team1:'Argentina',team2:'Austria',venue:'Dallas'},
            {id:58,group:'J',date:'2026-06-22',time:'23:00',team1:'Jordan',team2:'Algeria',venue:'Santa Clara'},
            {id:59,group:'J',date:'2026-06-27',time:'22:00',team1:'Algeria',team2:'Austria',venue:'Kansas City'},
            {id:60,group:'J',date:'2026-06-27',time:'22:00',team1:'Jordan',team2:'Argentina',venue:'Dallas'},
            {id:61,group:'K',date:'2026-06-17',time:'13:00',team1:'Portugal',team2:'ICPO-1',venue:'Houston'},
            {id:62,group:'K',date:'2026-06-17',time:'22:00',team1:'Uzbekistan',team2:'Colombia',venue:'Mexico City'},
            {id:63,group:'K',date:'2026-06-23',time:'13:00',team1:'Portugal',team2:'Uzbekistan',venue:'Houston'},
            {id:64,group:'K',date:'2026-06-23',time:'22:00',team1:'Colombia',team2:'ICPO-1',venue:'Guadalajara'},
            {id:65,group:'K',date:'2026-06-27',time:'15:00',team1:'ICPO-1',team2:'Uzbekistan',venue:'Monterrey'},
            {id:66,group:'K',date:'2026-06-27',time:'15:00',team1:'Colombia',team2:'Portugal',venue:'Atlanta'},
            {id:67,group:'L',date:'2026-06-17',time:'16:00',team1:'England',team2:'Croatia',venue:'Dallas'},
            {id:68,group:'L',date:'2026-06-17',time:'19:00',team1:'Ghana',team2:'Panama',venue:'Toronto'},
            {id:69,group:'L',date:'2026-06-23',time:'16:00',team1:'England',team2:'Ghana',venue:'Boston'},
            {id:70,group:'L',date:'2026-06-23',time:'19:00',team1:'Panama',team2:'Croatia',venue:'Toronto'},
            {id:71,group:'L',date:'2026-06-27',time:'17:00',team1:'Panama',team2:'England',venue:'New Jersey'},
            {id:72,group:'L',date:'2026-06-27',time:'17:00',team1:'Croatia',team2:'Ghana',venue:'Philadelphia'}
        ];

        const knockoutMatches = [
            // Round of 32 - Official FIFA bracket
            {id:73,stage:'R32',date:'2026-06-28',time:'15:00',team1:'RU-A',team2:'RU-B',venue:'Los Angeles'},
            {id:74,stage:'R32',date:'2026-06-29',time:'16:30',team1:'W-E',team2:'3rd-ABCDF',venue:'Boston'},
            {id:75,stage:'R32',date:'2026-06-29',time:'21:00',team1:'W-F',team2:'RU-C',venue:'Guadalajara'},
            {id:76,stage:'R32',date:'2026-06-29',time:'13:00',team1:'W-C',team2:'RU-F',venue:'Houston'},
            {id:77,stage:'R32',date:'2026-06-30',time:'17:00',team1:'W-I',team2:'3rd-CDFGH',venue:'New Jersey'},
            {id:78,stage:'R32',date:'2026-06-30',time:'13:00',team1:'RU-E',team2:'RU-I',venue:'Dallas'},
            {id:79,stage:'R32',date:'2026-06-30',time:'21:00',team1:'W-A',team2:'3rd-CEFHI',venue:'Mexico City'},
            {id:80,stage:'R32',date:'2026-07-01',time:'12:00',team1:'W-L',team2:'3rd-EHIJK',venue:'Atlanta'},
            {id:81,stage:'R32',date:'2026-07-01',time:'20:00',team1:'W-D',team2:'3rd-BEFIJ',venue:'Santa Clara'},
            {id:82,stage:'R32',date:'2026-07-01',time:'16:00',team1:'W-G',team2:'3rd-AEHIJ',venue:'Seattle'},
            {id:83,stage:'R32',date:'2026-07-02',time:'19:00',team1:'RU-K',team2:'RU-L',venue:'Toronto'},
            {id:84,stage:'R32',date:'2026-07-02',time:'15:00',team1:'W-H',team2:'RU-J',venue:'Los Angeles'},
            {id:85,stage:'R32',date:'2026-07-02',time:'23:00',team1:'W-B',team2:'3rd-EFGIJ',venue:'Vancouver'},
            {id:86,stage:'R32',date:'2026-07-03',time:'18:00',team1:'W-J',team2:'RU-H',venue:'Miami'},
            {id:87,stage:'R32',date:'2026-07-03',time:'21:30',team1:'W-K',team2:'3rd-DEIJL',venue:'Kansas City'},
            {id:88,stage:'R32',date:'2026-07-03',time:'14:00',team1:'RU-D',team2:'RU-G',venue:'Dallas'},
            
            // Round of 16 - Official FIFA bracket
            {id:89,stage:'R16',date:'2026-07-04',time:'17:00',team1:'W-74',team2:'W-77',venue:'Philadelphia'},
            {id:90,stage:'R16',date:'2026-07-04',time:'13:00',team1:'W-73',team2:'W-75',venue:'Houston'},
            {id:91,stage:'R16',date:'2026-07-05',time:'16:00',team1:'W-76',team2:'W-78',venue:'New Jersey'},
            {id:92,stage:'R16',date:'2026-07-05',time:'13:00',team1:'W-79',team2:'W-80',venue:'Guadalajara'},
            {id:93,stage:'R16',date:'2026-07-06',time:'15:00',team1:'W-83',team2:'W-84',venue:'Dallas'},
            {id:94,stage:'R16',date:'2026-07-06',time:'19:00',team1:'W-81',team2:'W-82',venue:'Seattle'},
            {id:95,stage:'R16',date:'2026-07-07',time:'13:00',team1:'W-86',team2:'W-88',venue:'Atlanta'},
            {id:96,stage:'R16',date:'2026-07-07',time:'17:00',team1:'W-85',team2:'W-87',venue:'Miami'},
            
            // Quarterfinals - Official FIFA bracket
            {id:97,stage:'QF',date:'2026-07-09',time:'16:30',team1:'W-89',team2:'W-90',venue:'Boston'},
            {id:98,stage:'QF',date:'2026-07-10',time:'15:00',team1:'W-93',team2:'W-94',venue:'Los Angeles'},
            {id:99,stage:'QF',date:'2026-07-11',time:'17:00',team1:'W-91',team2:'W-92',venue:'Miami'},
            {id:100,stage:'QF',date:'2026-07-11',time:'21:00',team1:'W-95',team2:'W-96',venue:'Kansas City'},
            
            // Semifinals
            {id:101,stage:'SF',date:'2026-07-14',time:'15:00',team1:'W-97',team2:'W-98',venue:'Dallas'},
            {id:102,stage:'SF',date:'2026-07-15',time:'15:00',team1:'W-99',team2:'W-100',venue:'Atlanta'},
            
            // Third Place
            {id:103,stage:'3P',date:'2026-07-18',time:'15:00',team1:'L-101',team2:'L-102',venue:'Miami'},
            
            // Final
            {id:104,stage:'F',date:'2026-07-19',time:'15:00',team1:'W-101',team2:'W-102',venue:'New Jersey'}
        ];

        // Functions
        function convertTime(timeStr, matchDate) {
            const [hours, minutes] = timeStr.split(':').map(Number);
            const offset = timezones[currentTimezone];
            
            // Calculate total minutes
            let totalMinutes = (hours * 60) + minutes + (offset * 60);
            let newDay = 0;
            
            // Handle day overflow
            while (totalMinutes < 0) {
                totalMinutes += 1440; // 24 hours in minutes
                newDay = -1;
            }
            while (totalMinutes >= 1440) {
                totalMinutes -= 1440;
                newDay = 1;
            }
            
            // Convert back to hours and minutes
            let newHours = Math.floor(totalMinutes / 60);
            let newMinutes = Math.round(totalMinutes % 60);
            
            const date = new Date(matchDate);
            date.setDate(date.getDate() + newDay);
            
            return {
                time: `${String(newHours).padStart(2, '0')}:${String(newMinutes).padStart(2, '0')}`,
                date: date.toISOString().split('T')[0]
            };
        }

        function formatDate(dateStr) {
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
        }

        function updateScore(matchId, team, value) {
            if (!scores[matchId]) scores[matchId] = {};
            scores[matchId][team] = value === '' ? '' : Math.max(0, parseInt(value) || 0);
            localStorage.setItem('wc2026scores', JSON.stringify(scores));
            renderGroups();
            renderKnockout();
        }

        function getGroupStandings(groupLetter) {
            const teams = groups[groupLetter];
            const standings = teams.map(team => ({
                team,
                played: 0,
                won: 0,
                drawn: 0,
                lost: 0,
                gf: 0,
                ga: 0,
                gd: 0,
                points: 0
            }));

            const groupGames = groupMatches.filter(m => m.group === groupLetter);
            
            groupGames.forEach(match => {
                const score = scores[match.id];
                if (score && score.team1 !== '' && score.team2 !== '') {
                    const score1 = parseInt(score.team1);
                    const score2 = parseInt(score.team2);
                    
                    const team1Stats = standings.find(s => s.team === match.team1);
                    const team2Stats = standings.find(s => s.team === match.team2);
                    
                    if (team1Stats && team2Stats) {
                        team1Stats.played++;
                        team2Stats.played++;
                        team1Stats.gf += score1;
                        team1Stats.ga += score2;
                        team2Stats.gf += score2;
                        team2Stats.ga += score1;
                        
                        if (score1 > score2) {
                            team1Stats.won++;
                            team1Stats.points += 3;
                            team2Stats.lost++;
                        } else if (score2 > score1) {
                            team2Stats.won++;
                            team2Stats.points += 3;
                            team1Stats.lost++;
                        } else {
                            team1Stats.drawn++;
                            team2Stats.drawn++;
                            team1Stats.points++;
                            team2Stats.points++;
                        }
                        
                        team1Stats.gd = team1Stats.gf - team1Stats.ga;
                        team2Stats.gd = team2Stats.gf - team2Stats.ga;
                    }
                }
            });

            return standings.sort((a, b) => {
                if (b.points !== a.points) return b.points - a.points;
                if (b.gd !== a.gd) return b.gd - a.gd;
                if (b.gf !== a.gf) return b.gf - a.gf;
                return 0;
            });
        }

        function getQualifiedTeam(placeholder, depth = 0) {
            // Prevent infinite recursion
            if (depth > 10) return placeholder;
            
            // Handle group winner placeholders (W-A, W-B, etc.)
            if (placeholder.startsWith('W-') && placeholder.length === 3) {
                const group = placeholder.split('-')[1];
                if (groups[group]) {
                    const standings = getGroupStandings(group);
                    return standings[0]?.team || placeholder;
                }
            }
            
            // Handle runner-up placeholders (RU-A, RU-B, etc.)
            if (placeholder.startsWith('RU-')) {
                const group = placeholder.split('-')[1];
                if (groups[group]) {
                    const standings = getGroupStandings(group);
                    return standings[1]?.team || placeholder;
                }
            }
            
            // Handle 3rd place placeholders (3rd-ABCDF, etc.)
            if (placeholder.startsWith('3rd-')) {
                const groupsList = placeholder.split('-')[1].split('');
                const thirdPlaceTeams = groupsList.map(g => {
                    const standings = getGroupStandings(g);
                    return standings[2] ? { ...standings[2], group: g } : null;
                }).filter(t => t !== null);
                
                // Sort by points, then GD, then GF
                thirdPlaceTeams.sort((a, b) => {
                    if (b.points !== a.points) return b.points - a.points;
                    if (b.gd !== a.gd) return b.gd - a.gd;
                    return b.gf - a.gf;
                });
                
                // Find the best team that hasn't been assigned yet
                for (let team of thirdPlaceTeams) {
                    const teamKey = `${team.group}-${team.team}`;
                    if (!assigned3rdPlaceTeams.has(teamKey)) {
                        assigned3rdPlaceTeams.add(teamKey);
                        return team.team;
                    }
                }
                
                // If all teams already assigned, return the best one (fallback)
                return thirdPlaceTeams[0]?.team || placeholder;
            }
            
            // Handle match winner placeholders (W-73, W-74, etc.)
            if (placeholder.startsWith('W-') && placeholder.length > 3) {
                const matchId = parseInt(placeholder.split('-')[1]);
                const match = knockoutMatches.find(m => m.id === matchId);
                if (!match) return placeholder;
                
                const matchScore = scores[matchId];
                if (matchScore && matchScore.team1 !== '' && matchScore.team2 !== '') {
                    const score1 = parseInt(matchScore.team1);
                    const score2 = parseInt(matchScore.team2);
                    
                    if (score1 > score2) {
                        return getQualifiedTeam(match.team1, depth + 1);
                    } else if (score2 > score1) {
                        return getQualifiedTeam(match.team2, depth + 1);
                    }
                }
                
                return placeholder;
            }
            
            // Handle match loser placeholders (L-101, L-102)
            if (placeholder.startsWith('L-')) {
                const matchId = parseInt(placeholder.split('-')[1]);
                const match = knockoutMatches.find(m => m.id === matchId);
                if (!match) return placeholder;
                
                const matchScore = scores[matchId];
                if (matchScore && matchScore.team1 !== '' && matchScore.team2 !== '') {
                    const score1 = parseInt(matchScore.team1);
                    const score2 = parseInt(matchScore.team2);
                    
                    if (score1 < score2) {
                        return getQualifiedTeam(match.team1, depth + 1);
                    } else if (score2 < score1) {
                        return getQualifiedTeam(match.team2, depth + 1);
                    }
                }
                
                return placeholder;
            }
            
            return placeholder;
        }

        function getMatchupPreview(placeholder, depth = 0) {
            // Prevent infinite recursion
            if (depth > 10) return placeholder;
            
            // For group-based placeholders, return the actual team
            if (placeholder.startsWith('W-') && placeholder.length === 3) {
                return getQualifiedTeam(placeholder, depth);
            }
            if (placeholder.startsWith('RU-') || placeholder.startsWith('3rd-')) {
                return getQualifiedTeam(placeholder, depth);
            }
            
            // For match-based placeholders
            if (placeholder.startsWith('W-') && placeholder.length > 3) {
                const matchId = parseInt(placeholder.split('-')[1]);
                const match = knockoutMatches.find(m => m.id === matchId);
                if (!match) return placeholder;
                
                const matchScore = scores[matchId];
                if (matchScore && matchScore.team1 !== '' && matchScore.team2 !== '') {
                    return getQualifiedTeam(placeholder, depth);
                } else {
                    const team1 = getMatchupPreview(match.team1, depth + 1);
                    const team2 = getMatchupPreview(match.team2, depth + 1);
                    
                    if (team1 !== match.team1 || team2 !== match.team2) {
                        return `${team1} / ${team2}`;
                    }
                }
            }
            
            if (placeholder.startsWith('L-')) {
                const matchId = parseInt(placeholder.split('-')[1]);
                const match = knockoutMatches.find(m => m.id === matchId);
                if (!match) return placeholder;
                
                const matchScore = scores[matchId];
                if (matchScore && matchScore.team1 !== '' && matchScore.team2 !== '') {
                    return getQualifiedTeam(placeholder, depth);
                }
            }
            
            return placeholder;
        }

        function renderGroups() {
            const container = document.getElementById('groupsContainer');
            container.innerHTML = '';

            Object.keys(groups).forEach(groupLetter => {
                const standings = getGroupStandings(groupLetter);
                const groupGames = groupMatches.filter(m => m.group === groupLetter);

                const groupCard = document.createElement('div');
                groupCard.className = 'group-card';
                
                let standingsHTML = `
                    <div class="group-title">Group ${groupLetter}</div>
                    <table class="standings-table">
                        <thead>
                            <tr>
                                <th>Team</th>
                                <th>P</th>
                                <th>W</th>
                                <th>D</th>
                                <th>L</th>
                                <th>GD</th>
                                <th>Pts</th>
                            </tr>
                        </thead>
                        <tbody>
                `;

                standings.forEach((team, idx) => {
                    standingsHTML += `
                        <tr class="${idx < 2 ? 'qualified' : ''}">
                            <td>${team.team}</td>
                            <td>${team.played}</td>
                            <td>${team.won}</td>
                            <td>${team.drawn}</td>
                            <td>${team.lost}</td>
                            <td>${team.gd > 0 ? '+' : ''}${team.gd}</td>
                            <td><strong>${team.points}</strong></td>
                        </tr>
                    `;
                });

                standingsHTML += '</tbody></table>';

                let matchesHTML = '';
                groupGames.forEach(match => {
                    const { time: convertedTime, date: convertedDate } = convertTime(match.time, match.date);
                    const matchScore = scores[match.id] || { team1: '', team2: '' };
                    
                    matchesHTML += `
                        <div class="match-card">
                            <div class="match-date">${formatDate(convertedDate)} â€¢ ${convertedTime} ${currentTimezone}</div>
                            <div class="match-teams">
                                <div class="team-name left">${match.team1}</div>
                                <div class="score-inputs">
                                    <input type="number" class="score-input" min="0" 
                                           value="${matchScore.team1}" 
                                           onchange="updateScore(${match.id}, 'team1', this.value)"
                                           placeholder="-">
                                    <span>:</span>
                                    <input type="number" class="score-input" min="0" 
                                           value="${matchScore.team2}" 
                                           onchange="updateScore(${match.id}, 'team2', this.value)"
                                           placeholder="-">
                                </div>
                                <div class="team-name right">${match.team2}</div>
                            </div>
                            <div class="match-venue">${match.venue}</div>
                        </div>
                    `;
                });

                groupCard.innerHTML = standingsHTML + matchesHTML;
                container.appendChild(groupCard);
            });
        }

        function renderKnockout() {
            // Reset assigned 3rd place teams each time we render
            assigned3rdPlaceTeams = new Set();
            
            const containers = {
                'R32': document.getElementById('r32Container'),
                'R16': document.getElementById('r16Container'),
                'QF': document.getElementById('qfContainer'),
                'SF': document.getElementById('sfContainer'),
                '3P': document.getElementById('thirdContainer'),
                'F': document.getElementById('finalContainer')
            };

            Object.keys(containers).forEach(stage => {
                const container = containers[stage];
                container.innerHTML = '';
                
                const stageMatches = knockoutMatches.filter(m => m.stage === stage);
                
                stageMatches.forEach(match => {
                    const { time: convertedTime, date: convertedDate } = convertTime(match.time, match.date);
                    const matchScore = scores[match.id] || { team1: '', team2: '' };
                    
                    const team1Name = getMatchupPreview(match.team1);
                    const team2Name = getMatchupPreview(match.team2);
                    
                    const team1IsPlaceholder = team1Name === match.team1 || team1Name.includes('/');
                    const team2IsPlaceholder = team2Name === match.team2 || team2Name.includes('/');
                    
                    // Check if this is the final and if there's a winner
                    let championHTML = '';
                    if (match.stage === 'F' && matchScore.team1 !== '' && matchScore.team2 !== '') {
                        const score1 = parseInt(matchScore.team1);
                        const score2 = parseInt(matchScore.team2);
                        if (score1 > score2) {
                            championHTML = `<div style="text-align: center; margin-top: 15px; padding: 15px; background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%); border-radius: 8px; font-size: 1.2em; font-weight: bold; color: #1e3c72;">ğŸ† ${team1Name} - WORLD CHAMPIONS 2026! ğŸ†</div>`;
                        } else if (score2 > score1) {
                            championHTML = `<div style="text-align: center; margin-top: 15px; padding: 15px; background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%); border-radius: 8px; font-size: 1.2em; font-weight: bold; color: #1e3c72;">ğŸ† ${team2Name} - WORLD CHAMPIONS 2026! ğŸ†</div>`;
                        }
                    }
                    
                    const matchCard = document.createElement('div');
                    matchCard.className = 'group-card';
                    matchCard.innerHTML = `
                        <div class="match-date">${formatDate(convertedDate)} â€¢ ${convertedTime} ${currentTimezone}</div>
                        <div class="match-teams">
                            <div class="team-name left" style="color: ${team1IsPlaceholder ? '#9ca3af' : '#ffffff'}; font-size: ${team1Name.includes('/') ? '0.85em' : '0.9em'}">${team1Name}</div>
                            <div class="score-inputs">
                                <input type="number" class="score-input" min="0" 
                                       value="${matchScore.team1}" 
                                       onchange="updateScore(${match.id}, 'team1', this.value)"
                                       placeholder="-">
                                <span>:</span>
                                <input type="number" class="score-input" min="0" 
                                       value="${matchScore.team2}" 
                                       onchange="updateScore(${match.id}, 'team2', this.value)"
                                       placeholder="-">
                            </div>
                            <div class="team-name right" style="color: ${team2IsPlaceholder ? '#9ca3af' : '#ffffff'}; font-size: ${team2Name.includes('/') ? '0.85em' : '0.9em'}">${team2Name}</div>
                        </div>
                        <div class="match-venue">${match.venue}</div>
                        ${championHTML}
                    `;
                    container.appendChild(matchCard);
                });
            });
        }

        function renderTimezoneButtons() {
            const container = document.getElementById('timezoneButtons');
            container.innerHTML = '';
            
            Object.keys(timezones).forEach(tz => {
                const btn = document.createElement('button');
                btn.className = `timezone-btn ${tz === currentTimezone ? 'active' : ''}`;
                btn.textContent = tz;
                btn.onclick = () => {
                    currentTimezone = tz;
                    document.getElementById('currentTimezone').textContent = tz;
                    renderTimezoneButtons();
                    renderGroups();
                    renderKnockout();
                };
                container.appendChild(btn);
            });
        }

        function toggleSettings() {
            const panel = document.getElementById('settingsPanel');
            panel.classList.toggle('active');
        }

        function resetAll() {
            if (confirm('Are you sure you want to reset all scores?')) {
                scores = {};
                localStorage.removeItem('wc2026scores');
                renderGroups();
                renderKnockout();
            }
        }

        function exportToCSV() {
            let csv = 'Match,Group,Date,Time,Team 1,Score 1,Score 2,Team 2,Venue\n';
            
            groupMatches.forEach(match => {
                const { time: convertedTime, date: convertedDate } = convertTime(match.time, match.date);
                const score = scores[match.id] || { team1: '', team2: '' };
                csv += `${match.id},${match.group},${convertedDate},${convertedTime},${match.team1},${score.team1},${score.team2},${match.team2},${match.venue}\n`;
            });
            
            csv += '\n\nGroup Standings\n';
            Object.keys(groups).forEach(groupLetter => {
                csv += `\nGroup ${groupLetter}\n`;
                csv += 'Team,Played,Won,Drawn,Lost,GF,GA,GD,Points\n';
                const standings = getGroupStandings(groupLetter);
                standings.forEach(s => {
                    csv += `${s.team},${s.played},${s.won},${s.drawn},${s.lost},${s.gf},${s.ga},${s.gd},${s.points}\n`;
                });
            });

            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'world_cup_2026_simulator.csv';
            a.click();
        }

        // Initialize
        renderTimezoneButtons();
        renderGroups();
        renderKnockout();
    </script>
</body>
</html>
